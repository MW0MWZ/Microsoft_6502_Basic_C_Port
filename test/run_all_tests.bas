10 REM ==========================================
20 REM  MICROSOFT 6502 BASIC - AUTOMATED TESTS
30 REM  STOPS ON FIRST FAILURE
40 REM ==========================================
50 PRINT "MICROSOFT 6502 BASIC TEST SUITE"
60 PRINT "================================"
70 PRINT
80 TC = 0
90 REM TC = TEST COUNT
100 REM
110 REM === ARITHMETIC TESTS ===
120 PRINT "TESTING ARITHMETIC..."
130 TC = TC + 1
140 IF 2 + 3 = 5 THEN 160
150 PRINT "FAIL: 2 + 3 <> 5": STOP
160 TC = TC + 1
170 IF 10 - 4 = 6 THEN 190
180 PRINT "FAIL: 10 - 4 <> 6": STOP
190 TC = TC + 1
200 IF 3 * 4 = 12 THEN 220
210 PRINT "FAIL: 3 * 4 <> 12": STOP
220 TC = TC + 1
230 IF 15 / 3 = 5 THEN 250
240 PRINT "FAIL: 15 / 3 <> 5": STOP
250 TC = TC + 1
260 IF 2 ^ 3 = 8 THEN 280
270 PRINT "FAIL: 2 ^ 3 <> 8": STOP
280 PRINT "  ARITHMETIC: PASS"
290 REM
300 REM === COMPARISON TESTS ===
310 PRINT "TESTING COMPARISONS..."
320 TC = TC + 1
330 IF (5 = 5) <> 0 THEN 350
340 PRINT "FAIL: 5 = 5 IS FALSE": STOP
350 TC = TC + 1
360 IF (5 < 10) <> 0 THEN 380
370 PRINT "FAIL: 5 < 10 IS FALSE": STOP
380 TC = TC + 1
390 IF (10 > 5) <> 0 THEN 410
400 PRINT "FAIL: 10 > 5 IS FALSE": STOP
410 TC = TC + 1
420 IF (5 <= 5) <> 0 THEN 440
430 PRINT "FAIL: 5 <= 5 IS FALSE": STOP
440 TC = TC + 1
450 IF (5 >= 5) <> 0 THEN 470
460 PRINT "FAIL: 5 >= 5 IS FALSE": STOP
470 TC = TC + 1
480 IF (5 <> 6) <> 0 THEN 500
490 PRINT "FAIL: 5 <> 6 IS FALSE": STOP
500 PRINT "  COMPARISONS: PASS"
510 REM
520 REM === VARIABLE TESTS ===
530 PRINT "TESTING VARIABLES..."
540 TC = TC + 1
550 A = 42
560 IF A = 42 THEN 580
570 PRINT "FAIL: A <> 42": STOP
580 TC = TC + 1
590 B = 3.14
600 IF B > 3.13 THEN 620
610 PRINT "FAIL: B NOT > 3.13": STOP
620 IF B < 3.15 THEN 640
630 PRINT "FAIL: B NOT < 3.15": STOP
640 TC = TC + 1
650 A$ = "TEST"
660 IF LEN(A$) = 4 THEN 680
670 PRINT "FAIL: LEN(A$) <> 4": STOP
680 PRINT "  VARIABLES: PASS"
690 REM
700 REM === MATH FUNCTION TESTS ===
710 PRINT "TESTING MATH FUNCTIONS..."
720 TC = TC + 1
730 IF ABS(-5) = 5 THEN 750
740 PRINT "FAIL: ABS(-5) <> 5": STOP
750 TC = TC + 1
760 IF ABS(5) = 5 THEN 780
770 PRINT "FAIL: ABS(5) <> 5": STOP
780 TC = TC + 1
790 IF SGN(-5) = -1 THEN 810
800 PRINT "FAIL: SGN(-5) <> -1": STOP
810 TC = TC + 1
820 IF SGN(0) = 0 THEN 840
830 PRINT "FAIL: SGN(0) <> 0": STOP
840 TC = TC + 1
850 IF SGN(5) = 1 THEN 870
860 PRINT "FAIL: SGN(5) <> 1": STOP
870 TC = TC + 1
880 IF INT(3.7) = 3 THEN 900
890 PRINT "FAIL: INT(3.7) <> 3": STOP
900 TC = TC + 1
910 IF INT(-3.7) = -4 THEN 930
920 PRINT "FAIL: INT(-3.7) <> -4": STOP
930 TC = TC + 1
940 IF SQR(16) = 4 THEN 960
950 PRINT "FAIL: SQR(16) <> 4": STOP
960 TC = TC + 1
970 IF SQR(25) = 5 THEN 990
980 PRINT "FAIL: SQR(25) <> 5": STOP
990 TC = TC + 1
1000 X = SIN(0)
1010 IF X > -0.001 THEN 1030
1020 PRINT "FAIL: SIN(0) TOO LOW": STOP
1030 IF X < 0.001 THEN 1050
1040 PRINT "FAIL: SIN(0) TOO HIGH": STOP
1050 TC = TC + 1
1060 X = COS(0)
1070 IF X > 0.999 THEN 1090
1080 PRINT "FAIL: COS(0) TOO LOW": STOP
1090 IF X < 1.001 THEN 1110
1100 PRINT "FAIL: COS(0) TOO HIGH": STOP
1110 TC = TC + 1
1120 X = EXP(1)
1130 IF X > 2.71 THEN 1150
1140 PRINT "FAIL: EXP(1) TOO LOW": STOP
1150 IF X < 2.72 THEN 1170
1160 PRINT "FAIL: EXP(1) TOO HIGH": STOP
1170 TC = TC + 1
1180 X = LOG(2.718281828)
1190 IF X > 0.99 THEN 1210
1200 PRINT "FAIL: LOG(E) TOO LOW": STOP
1210 IF X < 1.01 THEN 1230
1220 PRINT "FAIL: LOG(E) TOO HIGH": STOP
1230 PRINT "  MATH FUNCTIONS: PASS"
1240 REM
1250 REM === STRING FUNCTION TESTS ===
1260 PRINT "TESTING STRING FUNCTIONS..."
1270 TC = TC + 1
1280 IF LEN("HELLO") = 5 THEN 1300
1290 PRINT "FAIL: LEN(HELLO) <> 5": STOP
1300 TC = TC + 1
1310 IF LEN("") = 0 THEN 1330
1320 PRINT "FAIL: LEN() <> 0": STOP
1330 TC = TC + 1
1340 IF ASC("A") = 65 THEN 1360
1350 PRINT "FAIL: ASC(A) <> 65": STOP
1360 TC = TC + 1
1370 IF ASC("Z") = 90 THEN 1390
1380 PRINT "FAIL: ASC(Z) <> 90": STOP
1390 TC = TC + 1
1400 C$ = CHR$(65)
1410 IF ASC(C$) = 65 THEN 1430
1420 PRINT "FAIL: CHR$(65) <> A": STOP
1430 TC = TC + 1
1440 L$ = LEFT$("HELLO",3)
1450 IF LEN(L$) = 3 THEN 1470
1460 PRINT "FAIL: LEFT$(HELLO,3)": STOP
1470 TC = TC + 1
1480 R$ = RIGHT$("HELLO",3)
1490 IF LEN(R$) = 3 THEN 1510
1500 PRINT "FAIL: RIGHT$(HELLO,3)": STOP
1510 TC = TC + 1
1520 M$ = MID$("HELLO",2,3)
1530 IF LEN(M$) = 3 THEN 1550
1540 PRINT "FAIL: MID$(HELLO,2,3)": STOP
1550 TC = TC + 1
1560 X = VAL("123")
1570 IF X = 123 THEN 1590
1580 PRINT "FAIL: VAL(123) <> 123": STOP
1590 TC = TC + 1
1600 S$ = STR$(456)
1610 IF VAL(S$) = 456 THEN 1630
1620 PRINT "FAIL: STR$(456)": STOP
1630 PRINT "  STRING FUNCTIONS: PASS"
1640 REM
1650 REM === FOR/NEXT TESTS ===
1660 PRINT "TESTING FOR/NEXT..."
1670 TC = TC + 1
1680 S = 0
1690 FOR I = 1 TO 5
1700 S = S + I
1710 NEXT I
1720 IF S = 15 THEN 1740
1730 PRINT "FAIL: SUM 1-5 <> 15": STOP
1740 TC = TC + 1
1750 S = 0
1760 FOR I = 0 TO 10 STEP 2
1770 S = S + 1
1780 NEXT I
1790 IF S = 6 THEN 1810
1800 PRINT "FAIL: STEP 2 COUNT": STOP
1810 TC = TC + 1
1820 S = 0
1830 FOR I = 5 TO 1 STEP -1
1840 S = S + I
1850 NEXT I
1860 IF S = 15 THEN 1880
1870 PRINT "FAIL: COUNTDOWN SUM": STOP
1880 TC = TC + 1
1890 S = 0
1900 FOR I = 1 TO 3
1910 FOR J = 1 TO 3
1920 S = S + 1
1930 NEXT J
1940 NEXT I
1950 IF S = 9 THEN 1970
1960 PRINT "FAIL: NESTED LOOPS": STOP
1970 PRINT "  FOR/NEXT: PASS"
1980 REM
1990 REM === GOSUB/RETURN TESTS ===
2000 PRINT "TESTING GOSUB/RETURN..."
2010 TC = TC + 1
2020 GR = 0
2030 GOSUB 2500
2040 IF GR = 1 THEN 2060
2050 PRINT "FAIL: GOSUB NOT CALLED": STOP
2060 TC = TC + 1
2070 GR = 0
2080 GOSUB 2520
2090 IF GR = 2 THEN 2110
2100 PRINT "FAIL: NESTED GOSUB": STOP
2110 PRINT "  GOSUB/RETURN: PASS"
2120 REM
2130 REM === ARRAY TESTS ===
2140 PRINT "TESTING ARRAYS..."
2150 TC = TC + 1
2160 DIM AR(10)
2170 FOR I = 1 TO 10
2180 AR(I) = I * 2
2190 NEXT I
2200 IF AR(5) = 10 THEN 2220
2210 PRINT "FAIL: AR(5) <> 10": STOP
2220 TC = TC + 1
2230 IF AR(1) = 2 THEN 2250
2240 PRINT "FAIL: AR(1) <> 2": STOP
2250 TC = TC + 1
2260 IF AR(10) = 20 THEN 2280
2270 PRINT "FAIL: AR(10) <> 20": STOP
2280 TC = TC + 1
2290 DIM M(3,3)
2300 M(2,2) = 99
2310 IF M(2,2) = 99 THEN 2330
2320 PRINT "FAIL: M(2,2) <> 99": STOP
2330 PRINT "  ARRAYS: PASS"
2340 REM
2350 REM === LOGICAL OPERATORS ===
2360 PRINT "TESTING LOGICAL OPS..."
2370 TC = TC + 1
2380 IF (-1 AND -1) <> 0 THEN 2400
2390 PRINT "FAIL: T AND T": STOP
2400 TC = TC + 1
2410 IF (-1 AND 0) = 0 THEN 2430
2420 PRINT "FAIL: T AND F": STOP
2430 TC = TC + 1
2440 IF (-1 OR 0) <> 0 THEN 2460
2450 PRINT "FAIL: T OR F": STOP
2460 PRINT "  LOGICAL OPS: PASS"
2470 REM
2480 REM === ALL TESTS PASSED ===
2490 GOTO 2540
2500 GR = 1
2510 RETURN
2520 GOSUB 2500
2530 GR = GR + 1
2540 PRINT
2550 PRINT "================================"
2560 PRINT "ALL "; TC; " TESTS PASSED!"
2570 PRINT "================================"
2580 END
